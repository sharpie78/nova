# ğŸ› ï¸ Nova Developer Guide  

## ğŸ”€ Branch Structure  

- **main**: Production setup  
  - Clean repo for end users  
  - "Heavy" frontend files and AppImages are excluded from Git  
  - `setup.sh` downloads AppImages and models  

- **nova-dev**: Developer branch  
  - Full development branch  
  - Used for building/changing AppImages with Tauri and backend work  
  - Please always create sub-branches from `nova-dev` for new features/fixes

---

## ğŸ“ UI Folder Structure  

```
frontend/
â”œâ”€â”€ nova-editor/
â”‚   â”œâ”€â”€ node_modules/       # Installed by npm (ignored by git)
â”‚   â”œâ”€â”€ package.json        # Tauri project config (ignored by git)
â”‚   â”œâ”€â”€ package-lock.json   # Dependency lock (ignored by git)
â”‚   â”œâ”€â”€ README.md           # Local project readme (ignored by git)
â”‚   â”œâ”€â”€ src/                # HTML/CSS/JS source (tracked)
â”‚   â””â”€â”€ src-tauri/          # Tauri project files (ignored by git)
â”œâ”€â”€ nova-ui/
â”‚   â”œâ”€â”€ node_modules/       # Installed by npm (ignored by git)
â”‚   â”œâ”€â”€ package.json        # Tauri project config (ignored by git)
â”‚   â”œâ”€â”€ package-lock.json   # Dependency lock (ignored by git)
â”‚   â”œâ”€â”€ README.md           # Local project readme (ignored by git)
â”‚   â”œâ”€â”€ src/                # HTML/CSS/JS source (tracked)
â”‚   â””â”€â”€ src-tauri/          # Tauri project files (ignored by git)
```  

On **main**, only the code in `/src` and built AppImages should be published â€” `node_modules/` and `src-tauri/` etc are stripped out.  
If improvements or new features are added to the UI in your branch, please **build a new AppImage** as part of your development.  

---

- I'd prefer to be in charge of what gets updated for end users but...

If you want to merge `nova-dev` into `main`, add this alias to your shell config so the Editor/UI functions donâ€™t get overwritten:

âš ï¸ **Important:** Never merge `nova-dev` into `main` without this alias â€” otherwise the Editor/UI launch functions will get overwritten and break.

```bash
if ! grep -q "merge-dev-to-main" ~/.zshrc; then
  echo "alias merge-dev-to-main='git checkout main && git pull origin main && git merge --no-commit --no-ff nova-dev && git checkout --ours -- backend/servers/editor_router.py backend/tray/tray_ui.py && git add backend/servers/editor_router.py backend/tray/tray_ui.py && git commit -m \"Merge nova-dev into main (keep main editor/tray)\" && git push origin main'" >> ~/.zshrc
fi

source ~/.zshrc
```
- ### ğŸ›‘ Undo last merge (if something went wrong)

If the alias above was run and you need to roll back the last merge, run:

```bash
git reset --hard HEAD~1
git push origin main --force
```
or

```bash
if ! grep -q "merge-undo" ~/.zshrc; then
  echo "alias merge-undo='git reset --hard HEAD~1 && git push origin main --force'" >> ~/.zshrc
fi

source ~/.zshrc
```
and then run the alias

```bash
merge-undo
```
## âš™ï¸ Developer Setup  

1. Clone the repo into your home folder and checkout `nova-dev`:

```bash
git clone https://github.com/sharpie78/nova.git
cd nova
git checkout nova-dev
```  
2. you'll still need to run setup.sh

3. Set up Tauri manually see below or run the tauri_setup.sh file in setup folder.
   - Install Rust via rustup  
   - Install NVM and Node.js v22  
   - Ensure npm and npx are available  
   - Install required system libs (`libwebkit2gtk`, etc.)  

4. Install frontend deps and run with Tauri:

For **nova-editor**:  
```bash
cd frontend/nova-editor
npm install
npx tauri dev
```  

For **nova-ui**:  
```bash
cd frontend/nova-ui
npm install
npx tauri dev
```  

---

## ğŸš« Git Ignore Strategy  

| File/Folder                    | Tracked? | Notes                       |
|--------------------------------|----------|-----------------------------|
| `frontend/nova-*/src/`          | âœ… Yes   | Always tracked              |
| `frontend/nova-*/src-tauri/`    | âŒ No    | Local only, dev branch      |
| `frontend/nova-*/node_modules/` | âŒ No    | Generated by npm            |
| `*.AppImage`                    | âŒ No    | Downloaded by setup         |
| `config/admin.settings.json`    | âŒ No    | User-specific config        |
| `config/users.json`             | âŒ No    | User-specific config        |  

ğŸ‘‰ Also add your `<username>.settings.json` to `.gitignore`  

---

## ğŸ”„ Merging `nova-dev` â†’ `main`  

âš ï¸ **Please do not merge directly.**  
- All merges to `main` require approval â€” create a sub-branch of `nova-dev` and wait for review.  
- Approved merges should bring **src/** updates and new AppImages into `main` and the Releases section.  
- `node_modules/` and `src-tauri/` etc must not be merged.  
- Built AppImages should be uploaded to GitHub Releases. You are welcome to version them with any version suffix you wish.  

---

## ğŸ§ª Tools & Scripts  

- `nova/setup/setup.sh` â†’ Installs backend + downloads AppImages (available to all users)  
- `nova/setup/dev-tauri-setup.sh` â†’ Prepares Tauri for dev (dev branch only)  
- `nova/setup/backup-frontend.sh` â†’ Backup helper for frontend files (available to all users)  
- `nova/backend/utils/cuda_test.py` â†’ Test CUDA/GPU availability (available to all users)  
- `nova/backend/utils/test_routes.py` â†’ Quick check of backend API routes (available to all users)  

---

## ğŸ“ Tips

- backup Tauri-related files before switching branches.
- Treat `nova-dev` as the main development workspace, and create new features/fixes in sub-branches.
- Keep `main` clean for end users.
- Document any ignored files here or in the main README.
